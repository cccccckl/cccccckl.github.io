<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://cccccckl.github.io</id>
    <title>è¿˜æ˜¯pengå“¥å¼”</title>
    <updated>2020-10-16T06:29:09.042Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://cccccckl.github.io"/>
    <link rel="self" href="https://cccccckl.github.io/atom.xml"/>
    <subtitle>blog</subtitle>
    <logo>https://cccccckl.github.io/images/avatar.png</logo>
    <icon>https://cccccckl.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, è¿˜æ˜¯pengå“¥å¼”</rights>
    <entry>
        <title type="html"><![CDATA[å‘¨å¿—   2020/10/12 - 2020/10/18]]></title>
        <id>https://cccccckl.github.io/post/zhou-zhi-20201012-20201018/</id>
        <link href="https://cccccckl.github.io/post/zhou-zhi-20201012-20201018/">
        </link>
        <updated>2020-10-13T08:46:28.000Z</updated>
        <summary type="html"><![CDATA[<ul>
<li>å—¯ã€‚ã€‚ã€‚ã€‚  æ–¹ä¾¿ç®¡ç†å‘¨å¿— æ‰€ä»¥æäº†ä¸ª<strong>blog</strong>ğŸ•¶<br>
<img src="https://cccccckl.github.io/post-images/1602579079211.png" alt="" loading="lazy"></li>
</ul>
<h1 id="æ­£é¢˜å½“ç„¶è¿˜æ˜¯æ¥åˆ°pythonçˆ¬è™«çš„å­¦ä¹ ">æ­£é¢˜å½“ç„¶è¿˜æ˜¯æ¥åˆ°python<em>çˆ¬è™«</em>çš„å­¦ä¹ </h1>
<p>ä¹‹å‰æœ‰ç³»ç»Ÿçš„å­¦ä¹ è¿‡å…¶ä»–ç¼–è¯‘å‹è¯­è¨€ï¼Œpythonä½œä¸ºä¸€ç§è§£é‡Šå‹è¯­è¨€æˆ‘è§‰å¾—è¿˜æ˜¯è›®å¥½ç†è§£çš„ï¼Œåªæ˜¯å…¶ä¸­çš„ä¸€äº›ç‰¹æœ‰æœ¯è¯­ï¼ˆä¸€äº›åº“é‡Œçš„å‡½æ•°ä¹‹ç±»çš„ï¼‰ä¼šä¸å¤ªæ¸…æ¥šï¼ˆå¤šæŸ¥ç‚¹<br>
è€Œæˆ‘ä»¬éœ€è¦çš„åº”è¯¥æ˜¯ä¸€ä¸ªå®šå‘çˆ¬è™«</p>
<h3 id="è¿™æ˜¯ä¸€ä¸²æ­£åˆ™è¡¨è¾¾å¼">è¿™æ˜¯ä¸€ä¸²<strong>æ­£åˆ™è¡¨è¾¾å¼</strong></h3>
<pre><code>findLink = re.compile(r'&lt;a href=&quot;(.*?)&quot;&gt;')            # åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ï¼Œæ ‡å”®è§„åˆ™   å½±ç‰‡è¯¦æƒ…é“¾æ¥çš„è§„åˆ™
findImgSrc = re.compile(r'&lt;img.*src=&quot;(.*?)&quot;', re.S)
findTitle = re.compile(r'&lt;span class=&quot;title&quot;&gt;(.*)&lt;/span&gt;')
findRating = re.compile(r'&lt;span class=&quot;rating_num&quot; property=&quot;v:average&quot;&gt;(.*)&lt;/span&gt;')
findJudge = re.compile(r'&lt;span&gt;(\d*)äººè¯„ä»·&lt;/span&gt;')
findInq = re.compile(r'&lt;span class=&quot;inq&quot;&gt;(.*)&lt;/span&gt;')
findBd = re.compile(r'&lt;p class=&quot;&quot;&gt;(.*?)&lt;/p&gt;', re.S)
</code></pre>
<p>ç”¨æ¥åŒ¹é…ç½‘é¡µä¸­çš„ä¿¡æ¯ï¼Œä¸€å¼€å§‹æˆ‘ä¹Ÿå¥½å¥‡ä¸ºå•¥è¦ä¸“é—¨æä¸ªè¿™ç©æ„ï¼Œä¸ºå•¥ä¸ç”¨å­—ç¬¦ä¸²æ¥è¿›è¡ŒåŒ¹é…ï¼Œåé¢å‘ç°ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦çš„æŸ¥æ‰¾ç¡®å®æœ‰ç‚¹ç¦»è°±ï¼Œè¿™ä¸ªæ˜¯æŒ‰ç…§æŸä¸ªæ¨¡å¼è¿›è¡ŒåŒ¹é…ï¼Œä¸€è¡Œä»£ç æå®šï¼Œæ–¹ä¾¿å¤šäº†ã€‚<br>
<img src="https://cccccckl.github.io/post-images/1602817161593.png" alt="" loading="lazy"><br>
ä¸ŠGoogle charm F12æŠ“äº†ä¸€ä¸‹åŒ…ï¼Œçœ‹äº†å¥½ä¹…æ‰æ‰¾åˆ°= =ã€‚å¯¹æ¯”ä¸Šé¢çš„ä»£ç ä¸€çœ‹å°±èƒ½å‘ç°è¦çˆ¬çš„æ˜¯å•¥æ•°æ®äº†ã€‚</p>
<pre><code>a = re.compile()  #è¿›è¡Œé¢„ç¼–è¯‘ï¼Œåç»­éœ€è¦å¤§é‡é‡å¤æŸ¥æ‰¾æ“ä½œï¼Œä½¿ç”¨é¢„ç¼–è¯‘é«˜æ•ˆå¾ˆå¤š
</code></pre>
]]></summary>
        <content type="html"><![CDATA[<ul>
<li>å—¯ã€‚ã€‚ã€‚ã€‚  æ–¹ä¾¿ç®¡ç†å‘¨å¿— æ‰€ä»¥æäº†ä¸ª<strong>blog</strong>ğŸ•¶<br>
<img src="https://cccccckl.github.io/post-images/1602579079211.png" alt="" loading="lazy"></li>
</ul>
<h1 id="æ­£é¢˜å½“ç„¶è¿˜æ˜¯æ¥åˆ°pythonçˆ¬è™«çš„å­¦ä¹ ">æ­£é¢˜å½“ç„¶è¿˜æ˜¯æ¥åˆ°python<em>çˆ¬è™«</em>çš„å­¦ä¹ </h1>
<p>ä¹‹å‰æœ‰ç³»ç»Ÿçš„å­¦ä¹ è¿‡å…¶ä»–ç¼–è¯‘å‹è¯­è¨€ï¼Œpythonä½œä¸ºä¸€ç§è§£é‡Šå‹è¯­è¨€æˆ‘è§‰å¾—è¿˜æ˜¯è›®å¥½ç†è§£çš„ï¼Œåªæ˜¯å…¶ä¸­çš„ä¸€äº›ç‰¹æœ‰æœ¯è¯­ï¼ˆä¸€äº›åº“é‡Œçš„å‡½æ•°ä¹‹ç±»çš„ï¼‰ä¼šä¸å¤ªæ¸…æ¥šï¼ˆå¤šæŸ¥ç‚¹<br>
è€Œæˆ‘ä»¬éœ€è¦çš„åº”è¯¥æ˜¯ä¸€ä¸ªå®šå‘çˆ¬è™«</p>
<h3 id="è¿™æ˜¯ä¸€ä¸²æ­£åˆ™è¡¨è¾¾å¼">è¿™æ˜¯ä¸€ä¸²<strong>æ­£åˆ™è¡¨è¾¾å¼</strong></h3>
<pre><code>findLink = re.compile(r'&lt;a href=&quot;(.*?)&quot;&gt;')            # åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ï¼Œæ ‡å”®è§„åˆ™   å½±ç‰‡è¯¦æƒ…é“¾æ¥çš„è§„åˆ™
findImgSrc = re.compile(r'&lt;img.*src=&quot;(.*?)&quot;', re.S)
findTitle = re.compile(r'&lt;span class=&quot;title&quot;&gt;(.*)&lt;/span&gt;')
findRating = re.compile(r'&lt;span class=&quot;rating_num&quot; property=&quot;v:average&quot;&gt;(.*)&lt;/span&gt;')
findJudge = re.compile(r'&lt;span&gt;(\d*)äººè¯„ä»·&lt;/span&gt;')
findInq = re.compile(r'&lt;span class=&quot;inq&quot;&gt;(.*)&lt;/span&gt;')
findBd = re.compile(r'&lt;p class=&quot;&quot;&gt;(.*?)&lt;/p&gt;', re.S)
</code></pre>
<p>ç”¨æ¥åŒ¹é…ç½‘é¡µä¸­çš„ä¿¡æ¯ï¼Œä¸€å¼€å§‹æˆ‘ä¹Ÿå¥½å¥‡ä¸ºå•¥è¦ä¸“é—¨æä¸ªè¿™ç©æ„ï¼Œä¸ºå•¥ä¸ç”¨å­—ç¬¦ä¸²æ¥è¿›è¡ŒåŒ¹é…ï¼Œåé¢å‘ç°ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦çš„æŸ¥æ‰¾ç¡®å®æœ‰ç‚¹ç¦»è°±ï¼Œè¿™ä¸ªæ˜¯æŒ‰ç…§æŸä¸ªæ¨¡å¼è¿›è¡ŒåŒ¹é…ï¼Œä¸€è¡Œä»£ç æå®šï¼Œæ–¹ä¾¿å¤šäº†ã€‚<br>
<img src="https://cccccckl.github.io/post-images/1602817161593.png" alt="" loading="lazy"><br>
ä¸ŠGoogle charm F12æŠ“äº†ä¸€ä¸‹åŒ…ï¼Œçœ‹äº†å¥½ä¹…æ‰æ‰¾åˆ°= =ã€‚å¯¹æ¯”ä¸Šé¢çš„ä»£ç ä¸€çœ‹å°±èƒ½å‘ç°è¦çˆ¬çš„æ˜¯å•¥æ•°æ®äº†ã€‚</p>
<pre><code>a = re.compile()  #è¿›è¡Œé¢„ç¼–è¯‘ï¼Œåç»­éœ€è¦å¤§é‡é‡å¤æŸ¥æ‰¾æ“ä½œï¼Œä½¿ç”¨é¢„ç¼–è¯‘é«˜æ•ˆå¾ˆå¤š
</code></pre>
<!-- more -->
<pre><code>. #ç‚¹å¯ä»£è¡¨ä¸€åˆ‡å­—ç¬¦

\ # èµ·è½¬ä¹‰ä½œç”¨

[...] # æŒ‡ä»£æ–¹æ‹¬å·ä¸­çš„ä»»æ„å­—ç¬¦

\d # æŒ‡ä»£æ•°å­—0-9

\D # æŒ‡ä»£éæ•°å­—

\s # æŒ‡ä»£ä¸€åˆ‡ç©ºæ ¼ï¼ŒåŒ…æ‹¬tabåˆ¶è¡¨ç¬¦ã€ç©ºæ ¼ã€æ¢è¡Œç­‰

\S # æŒ‡ä»£éç©ºæ ¼

\w # æŒ‡ä»£å¤§å°å†™å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿

\W # æŒ‡ä»£éå¤§å°å†™å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿

* # åŒ¹é…å‰é¢å­—ç¬¦ &gt;=0 æ¬¡

+ # åŒ¹é…å‰é¢å­—ç¬¦1æ¬¡åŠä»¥ä¸Š

? # åŒ¹é…å‰é¢å­—ç¬¦0æ¬¡æˆ–1æ¬¡

{m} # åŒ¹é…mæ¬¡

{m,n} # åŒ¹é…måˆ°næ¬¡

{m,} # è‡³å°‘åŒ¹é…mæ¬¡
</code></pre>
<h3 id="å¾—åˆ°æŒ‡å®šä¸€ä¸ªurlçš„ç½‘é¡µå†…å®¹">å¾—åˆ°æŒ‡å®šä¸€ä¸ªURLçš„ç½‘é¡µå†…å®¹</h3>
<pre><code>def askURL(url):
head = { &quot;User-Agent&quot;: &quot;Mozilla / 5.0(Windows NT 10.0; Win64; x64) AppleWebKit / 537.36(KHTML, like Gecko) Chrome / 80.0.3987.122  Safari / 537.36&quot;
}
# ç”¨æˆ·ä»£ç†ï¼Œè¡¨ç¤ºå‘Šè¯‰è±†ç“£æœåŠ¡å™¨ï¼Œæˆ‘ä»¬æ˜¯ä»€ä¹ˆç±»å‹çš„æœºå™¨ã€æµè§ˆå™¨ï¼ˆæœ¬è´¨ä¸Šæ˜¯å‘Šè¯‰æµè§ˆå™¨ï¼Œæˆ‘ä»¬å¯ä»¥æ¥æ”¶ä»€ä¹ˆæ°´å¹³çš„æ–‡ä»¶å†…å®¹ï¼‰

request = urllib.request.Request(url, headers=head)
html = &quot;&quot;
try: 
    response = urllib.request.urlopen(request)
    html = response.read().decode(&quot;utf-8&quot;)
except urllib.error.URLError as e:
if hasattr(e, &quot;code&quot;):
    print(e.code)
if hasattr(e, &quot;reason&quot;):
    print(e.reason)
return html
</code></pre>
<p>å¹¶ä¸æ˜¯å¾ˆæ‡‚è¿™æ®µï¼Œè¿™æ®µåº”è¯¥æ˜¯æŠŠç½‘é¡µçš„æºç æ‹”ä¸‹æ¥å§ã€‚å®ƒå’‹å®ç°çš„ä¸æ˜¯å¾ˆæ˜ç™½ã€‚</p>
<h3 id="çˆ¬å–ç½‘é¡µ">çˆ¬å–ç½‘é¡µ</h3>
<pre><code>def getData(baseurl):
datalist = []  #ç”¨æ¥å­˜å‚¨çˆ¬å–çš„ç½‘é¡µä¿¡æ¯
for i in range(0, 10):  # è°ƒç”¨è·å–é¡µé¢ä¿¡æ¯çš„å‡½æ•°ï¼Œ10æ¬¡
    url = baseurl + str(i * 25)
    html = askURL(url)  # ä¿å­˜è·å–åˆ°çš„ç½‘é¡µæºç 
    # 2.é€ä¸€è§£ææ•°æ®
    soup = BeautifulSoup(html, &quot;html.parser&quot;)
    for item in soup.find_all('div', class_=&quot;item&quot;):  # æŸ¥æ‰¾ç¬¦åˆè¦æ±‚çš„å­—ç¬¦ä¸²
        data = []  # ä¿å­˜ä¸€éƒ¨ç”µå½±æ‰€æœ‰ä¿¡æ¯
        item = str(item)
        link = re.findall(findLink, item)[0]  # é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾
        data.append(link)
        imgSrc = re.findall(findImgSrc, item)[0]
        data.append(imgSrc)
        titles = re.findall(findTitle, item)
        if (len(titles) == 2):
            ctitle = titles[0]
            data.append(ctitle)
            otitle = titles[1].replace(&quot;/&quot;, &quot;&quot;)  #æ¶ˆé™¤è½¬ä¹‰å­—ç¬¦
            data.append(otitle)
        else:
            data.append(titles[0])
            data.append(' ')
        rating = re.findall(findRating, item)[0]
        data.append(rating)
        judgeNum = re.findall(findJudge, item)[0]
        data.append(judgeNum)
        inq = re.findall(findInq, item)
        if len(inq) != 0:
            inq = inq[0].replace(&quot;ã€‚&quot;, &quot;&quot;)
            data.append(inq)
        else:
            data.append(&quot; &quot;)
        bd = re.findall(findBd, item)[0]
        bd = re.sub('&lt;br(\s+)?/&gt;(\s+)?', &quot;&quot;, bd)
        bd = re.sub('/', &quot;&quot;, bd)
        data.append(bd.strip())
        datalist.append(data)
 return datalist
</code></pre>
<p>è¿™ä¸€æ®µå°±å¼€å§‹ç½‘é¡µçš„çˆ¬å–äº†</p>
<pre><code>soup = BeautifulSoup(html, &quot;html.parser&quot;)  #å¯¹ç½‘é¡µè¿›è¡Œè§£æï¼Œå°†htmlæ–‡æ¡£è§£ææˆæ–‡æ¡£æ ‘ï¼Œè¿”å›bså¯¹è±¡

soup.find_all('div', class_=&quot;item&quot;)  #æ‰¾åˆ°&lt;div class = &quot;item&quot;&gt;
</code></pre>
<!-- more -->
<pre><code>titles = re.findall(findTitle, item)
        if (len(titles) == 2):
            ctitle = titles[0]
            data.append(ctitle)
            otitle = titles[1].replace(&quot;/&quot;, &quot;&quot;)  #æ¶ˆé™¤è½¬ä¹‰å­—ç¬¦
            data.append(otitle)
        else:
            data.append(titles[0])
            data.append(' ')
</code></pre>
<p>è¿™ä¸€éƒ¨åˆ†å¯¹ç”µå½±åè¿›è¡Œæå–ï¼Œå³ä»ä¸‹åˆ—ä¸­è¿›è¡Œæå–<br>
<img src="https://cccccckl.github.io/post-images/1602828392403.png" alt="" loading="lazy"></p>
<pre><code>bd = re.findall(findBd, item)[0]
bd = re.sub('&lt;br(\s+)?/&gt;(\s+)?', &quot;&quot;, bd)      #æ¶ˆå»ç©ºæ ¼
bd = re.sub('/', &quot;&quot;, bd)
data.append(bd.strip())
</code></pre>
<p>è€Œè¿™ä¸€éƒ¨åˆ†åˆ™æ˜¯å¯¹ä¸‹é¢çš„ç›¸å…³ä¿¡æ¯è¿›è¡Œå¤„ç†<br>
<img src="https://cccccckl.github.io/post-images/1602829158225.png" alt="" loading="lazy"></p>
<h3 id="ä¿å­˜æ•°æ®åˆ°è¡¨æ ¼">ä¿å­˜æ•°æ®åˆ°è¡¨æ ¼</h3>
<pre><code>def saveData(datalist,savepath):
print(&quot;save.......&quot;)
book = xlwt.Workbook(encoding=&quot;utf-8&quot;,style_compression=0) #åˆ›å»ºworkbookå¯¹è±¡
sheet = book.add_sheet('è±†ç“£ç”µå½±Top250', cell_overwrite_ok=True) #åˆ›å»ºå·¥ä½œè¡¨
col = (&quot;ç”µå½±è¯¦æƒ…é“¾æ¥&quot;,&quot;å›¾ç‰‡é“¾æ¥&quot;,&quot;å½±ç‰‡ä¸­æ–‡å&quot;,&quot;å½±ç‰‡å¤–å›½å&quot;,&quot;è¯„åˆ†&quot;,&quot;è¯„ä»·æ•°&quot;,&quot;æ¦‚å†µ&quot;,&quot;ç›¸å…³ä¿¡æ¯&quot;)
for i in range(0,8):
    sheet.write(0,i,col[i])  #åˆ—å
for i in range(0,250):
    data = datalist[i]
    for j in range(0,8):
        sheet.write(i+1,j,data[j])  #æ•°æ®
book.save(savepath) #ä¿å­˜
</code></pre>
<p>è¿™ä¸€ä»½çˆ¬è™«ä»£ç æ˜¯ä»ç½‘ä¸Šcopyæ¥çš„ï¼Œæˆ‘æƒ³æ ¹æ®é‡Œé¢çš„ä¸€äº›ç»“æ„å•Šï¼Œè¯­æ³•å•Šä¹‹ç±»çš„æ¥å­¦ä¹ ï¼Œè¾¹çœ‹è¾¹å†™ï¼Œä¸ä¼šå†™çš„æ—¶å€™å†å›å»çœ‹ï¼Œçœ‹ä¸æ‡‚å°±å»æŸ¥ï¼Œå°±è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹ã€‚</p>
<h1 id="å‘¨è®¡åˆ’">å‘¨è®¡åˆ’</h1>
<h2 id="æœ¬å‘¨">æœ¬å‘¨</h2>
<ul class="contains-task-list">
<li class="task-list-item"><input class="task-list-item-checkbox" checked="" disabled="" type="checkbox" id="task-item-8131871"><label class="task-list-item-label" for="task-item-8131871"> ï¼ˆåˆæ­¥ï¼‰çœ‹æ‡‚åˆ«äººå†™çš„çˆ¬è™«</label>
<ul class="contains-task-list">
<li class="task-list-item"><input class="task-list-item-checkbox" checked="" disabled="" type="checkbox" id="task-item-6623454"><label class="task-list-item-label" for="task-item-6623454"> æœºå™¨å­¦ä¹ å¼€ç¯‡</label></li>
</ul>
</li>
</ul>
<h2 id="ä¸‹å‘¨">ä¸‹å‘¨</h2>
<ul class="contains-task-list">
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox" id="task-item-2240699"><label class="task-list-item-label" for="task-item-2240699"> å°è¯•è‡ªå·±å†™ä¸ªçˆ¬è™«</label></li>
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox" id="task-item-8928074"><label class="task-list-item-label" for="task-item-8928074"> å¼€å§‹å­¦ä¹ æœºå™¨å­¦ä¹ æ–¹é¢çš„å†…å®¹</label></li>
</ul>
]]></content>
    </entry>
</feed>